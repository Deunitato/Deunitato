---
layout: post
title: 'CS2040s: Lecture 8 - Balanced Binary Search Tree (AVL)'
date: '2019-09-11T00:39:00.000-07:00'
author: Charlotte Deunitato
tags: 
modified_time: '2019-09-23T02:59:38.977-07:00'
thumbnail: https://1.bp.blogspot.com/-kHe3PIr3A3s/XYiK3MC35vI/AAAAAAAACKM/vctlynoUpGseW3b1fehbYYYIevPZH23-ACLcBGAsYHQ/s72-c/1.PNG
blogger_id: tag:blogger.com,1999:blog-4520250687931855860.post-9089639936597983116
blogger_orig_url: https://nusmods.blogspot.com/2019/09/cs2040s-lecture-8-balanced-binary.html
---

<h2>Balanced Binary Search Tree (AVL)</h2><h3>AVL TREES</h3><div>Perfectly Balance, as all things should be.</div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-kHe3PIr3A3s/XYiK3MC35vI/AAAAAAAACKM/vctlynoUpGseW3b1fehbYYYIevPZH23-ACLcBGAsYHQ/s1600/1.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="331" data-original-width="361" height="293" src="https://1.bp.blogspot.com/-kHe3PIr3A3s/XYiK3MC35vI/AAAAAAAACKM/vctlynoUpGseW3b1fehbYYYIevPZH23-ACLcBGAsYHQ/s320/1.PNG" width="320" /></a></div><div><br /></div><div>Previously, when look at normal BST, if it is imbalance, its o(n). But if it is balance,</div><div>ie. h= logn always =&gt; O(logn)</div><div><br /></div><div>1. Keep a height variable at each node</div><div><span class="fontstyle0">o.height = max(o.left.height, o.right.height) + 1</span>&nbsp;</div><div><br /></div><div>2.<u>Maintain the variant: All nodes in BST must be height balanced&nbsp;</u></div><div>Both sides must be height balanced.</div><div><span class="fontstyle0">|o.left.height() – o.right.height()| </span><span class="fontstyle2">≤ 1</span></div><div><span class="fontstyle2"><br /></span></div><div><span class="fontstyle2">3. Rebalance via rotations</span><br /><span class="fontstyle2"><br /></span></div><div><span class="fontstyle2">Balance Factor:</span></div><div><span class="fontstyle2"><span class="fontstyle0">&nbsp; Define b(o) = o.left.height() – o.right.height()<br />&nbsp; b(o) of an empty tree (null) is -1 //its oni one side<br />&nbsp; if b(o) &gt; 1 or b(o) &lt; -1 for any o, the tree is no&nbsp;longer height balanced.</span><span class="fontstyle2">&nbsp;&nbsp;</span></span><br /><span class="fontstyle2"><span class="fontstyle2"><br /></span></span><span class="fontstyle2"><span class="fontstyle2">Ensure that both left and right side of the node has at most a difference of 1</span></span><br /><span class="fontstyle2"><span class="fontstyle2"><br /></span></span></div><div>Balancing O(n) time because we need to go through every element to count.</div><div><span class="fontstyle2"><br /></span></div><div><span class="fontstyle2">Claim:</span></div><div><span class="fontstyle2">A height balance tree with n nodes has at most height h&lt; 2logn so</span></div><div><span class="fontstyle2">Time to do any operation on the tree -&gt; h= O(logn)</span></div><div><br /></div><h4><span class="fontstyle2">Rotations</span></h4><div><span class="fontstyle0">4 types:</span><br /><span class="fontstyle2"> </span><span class="fontstyle0">Left rotation</span><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-E0vjDvRplxA/XYiNef4j7SI/AAAAAAAACKY/La2lAzyQuTY3SC68XH0mEkqg_D0RNJQcACLcBGAsYHQ/s1600/2.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="323" data-original-width="760" height="170" src="https://1.bp.blogspot.com/-E0vjDvRplxA/XYiNef4j7SI/AAAAAAAACKY/La2lAzyQuTY3SC68XH0mEkqg_D0RNJQcACLcBGAsYHQ/s400/2.PNG" width="400" /></a></div><span class="fontstyle0"><br /></span><span class="fontstyle0"><br /></span><span class="fontstyle0">Applies: Y is X 's right child</span><br /><span class="fontstyle0">Objective: Want y to be X's parents but need to preserve BST properties</span><br /><span class="fontstyle0"><br /></span><span class="fontstyle0">We want to shift Y up one level and X down one level</span><br /><span class="fontstyle0"><br /></span><span class="fontstyle0"><span style="color: red;"><b>What is the worst case time complexity of left rotation</b></span></span><br /><span class="fontstyle0"><span style="color: red;"><b>O(1)</b></span></span><br /><span class="fontstyle0">-&gt;We are just moving references around</span><br /><span class="fontstyle0"><br /></span><span class="fontstyle0"><span class="fontstyle0">function rotateLeft(x)<br />&nbsp; &nbsp;y = x.right&nbsp;</span><span class="fontstyle0" style="color: #3e8853;">// reassign parent</span></span><br /><span class="fontstyle0"><span class="fontstyle0">&nbsp; &nbsp;y.parent = x.parent&nbsp;</span><span class="fontstyle0" style="color: #3e8853;">// make y into x’s parent</span></span><br /><span class="fontstyle0"><span class="fontstyle0" style="color: #3e8853;">&nbsp;</span><span class="fontstyle0">&nbsp; x.parent = y&nbsp;</span><span class="fontstyle0" style="color: #3e8853;">// move B</span><span class="fontstyle0">&nbsp; x.right = y.left<br />&nbsp; if (x.right is not null)<br />&nbsp; &nbsp; &nbsp; x.right.parent = x&nbsp;</span><span class="fontstyle0" style="color: #3e8853;">// make x into y’s child</span></span><br /><span class="fontstyle0"><span class="fontstyle0">&nbsp; y.left = x&nbsp;</span><span class="fontstyle0" style="color: #3e8853;">// update heights and parent reference</span><span class="fontstyle0">return y</span>&nbsp;</span><br /><span class="fontstyle0"><b><span style="color: red;"><br /></span></b></span><span class="fontstyle0"><b><span style="color: red;">//We need to write for both sides x and y</span></b></span><br /><span class="fontstyle0"><b><span style="color: red;"><br /></span></b></span><span class="fontstyle0"><b><span style="color: red;">Is the BST property preserved for the parent?</span></b></span><br /><span class="fontstyle0"><b><span style="color: red;">Yes</span></b>&nbsp;</span><br /><span class="fontstyle0"><br /></span><span class="fontstyle2"> </span><span class="fontstyle0">Right rotation</span><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-VZrfxqii3kw/XYiO_KzC31I/AAAAAAAACKk/OYBX0H57ktAnusue4EsOLayzUtU7WFOWgCLcBGAsYHQ/s1600/3.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="333" data-original-width="782" height="170" src="https://1.bp.blogspot.com/-VZrfxqii3kw/XYiO_KzC31I/AAAAAAAACKk/OYBX0H57ktAnusue4EsOLayzUtU7WFOWgCLcBGAsYHQ/s400/3.PNG" width="400" /></a></div><span class="fontstyle0"><br /></span><span class="fontstyle0"><span class="fontstyle0">Objective</span><span class="fontstyle1">: Want y to be x’s parent<br />But must preserve BST properties.</span><span class="fontstyle0">Applies</span><span class="fontstyle1">: y is x’s left child.</span></span><br /><span class="fontstyle0"><span class="fontstyle0">function rotateRight(x)<br />&nbsp; y = x.left&nbsp;</span><span class="fontstyle0" style="color: #3e8853;">// reassign parent</span></span><br /><span class="fontstyle0"><span class="fontstyle0">&nbsp; y.parent = x.parent</span><span class="fontstyle0" style="color: #3e8853;">// make y into x’s parent</span></span><br /><span class="fontstyle0"><span class="fontstyle0">&nbsp; x.parent = y&nbsp;</span><span class="fontstyle0" style="color: #3e8853;">// move B</span></span><br /><span class="fontstyle0"><span class="fontstyle0">&nbsp; x.left = y.right<br />&nbsp; if (x.left is not null)<br />&nbsp; &nbsp; &nbsp;x.left.parent = x&nbsp;</span><span class="fontstyle0" style="color: #3e8853;">// make x into y’s child</span></span><br /><span class="fontstyle0"><span class="fontstyle0">y.right = x&nbsp;</span><span class="fontstyle0" style="color: #3e8853;">// update heights and parent reference</span></span><br /><span class="fontstyle0"><span class="fontstyle0">return y</span>&nbsp;&nbsp;</span><br /><span class="fontstyle0"><br /></span><span class="fontstyle0" style="color: red;"><b>We turn Right when node is imbalance on the left (Left side is longer)</b></span><br /><span class="fontstyle0" style="color: red;"><b>Turn left if node is imbalance on the right</b></span><br /><span class="fontstyle0"><br /></span><span class="fontstyle0">  </span><span class="fontstyle2"> </span><span class="fontstyle0">Left-Right rotation</span><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-qOA8S2Anyjw/XYiQemRab3I/AAAAAAAACKw/6BH8DZATy-8JXLdRO1QDmh5oE_82oz0fQCLcBGAsYHQ/s1600/4.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="335" data-original-width="808" height="165" src="https://1.bp.blogspot.com/-qOA8S2Anyjw/XYiQemRab3I/AAAAAAAACKw/6BH8DZATy-8JXLdRO1QDmh5oE_82oz0fQCLcBGAsYHQ/s400/4.PNG" width="400" /></a></div><span class="fontstyle0"><br /></span><span class="fontstyle0">AKA Double right</span><br />left rotate my left child first before right rotate myself<br /><span class="fontstyle0">If the unbalance side follow this order: node , left, right</span><br /><span class="fontstyle0"><br /></span><span class="fontstyle0"><br /></span><span class="fontstyle0"><br /></span><span class="fontstyle2"> </span><span class="fontstyle0">Right-Left rotation</span><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-ejzp2SY77tM/XYiQp9TSbcI/AAAAAAAACK0/6BEsFdeHhIIJPzystwcKo7bJeur8Sen4wCLcBGAsYHQ/s1600/5.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="313" data-original-width="766" height="162" src="https://1.bp.blogspot.com/-ejzp2SY77tM/XYiQp9TSbcI/AAAAAAAACK0/6BEsFdeHhIIJPzystwcKo7bJeur8Sen4wCLcBGAsYHQ/s400/5.PNG" width="400" /></a></div><br /><span class="fontstyle0"><br /></span><span class="fontstyle0">AKA double left</span><br /><span class="fontstyle0">right rotate my right child first before left rotate myself</span><br /><span class="fontstyle0">If the unbalance side follow this order: node , right , left</span><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-7sOYxpMuCUA/XYiR4sZ4luI/AAAAAAAACLE/NDEIctkigvEZo1Dl6S31r8Kvu_lcllBiwCLcBGAsYHQ/s1600/6.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="184" data-original-width="410" height="178" src="https://1.bp.blogspot.com/-7sOYxpMuCUA/XYiR4sZ4luI/AAAAAAAACLE/NDEIctkigvEZo1Dl6S31r8Kvu_lcllBiwCLcBGAsYHQ/s400/6.PNG" width="400" /></a></div><span class="fontstyle0"><br /></span><span class="fontstyle0"><br /></span><span class="fontstyle0"><b><span style="color: red;">Inbalance can be caused by insertion and deletion</span></b></span><br /><span class="fontstyle0"><span class="fontstyle0"><br /></span></span><span class="fontstyle0"><span class="fontstyle0">if tree is right heavy<br />&nbsp; &nbsp;if tree’s right subtree is left heavy<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; right rotate, left rotate<br />&nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; left rotate<br />else if tree is left heavy<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if tree’s left subtree is right heavy<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; left rotate, right rotate<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; right rotate</span></span><br /><span class="fontstyle0"><span class="fontstyle0"><br /></span></span><span class="fontstyle0">We need to check</span><br /><span class="fontstyle0">1. Parent is balance</span><br /><span class="fontstyle0">2. If parent is not balance, check the child on the side which is imbalance</span><br /><span class="fontstyle0">&nbsp; &nbsp; if the child has balance factor 's sign is opposite of the parents, its a double rotate</span><br /><span class="fontstyle0">&nbsp; &nbsp; else its just a single rotate</span><br /><br /><b>When to balance?</b><br /><b><span style="color: red;">Can rotation increase height of tree? No, it either decrease by one or leave it the same</span></b><br /><b><span style="color: red;">Rotation required after insert: 1,</span></b>&nbsp;Just swap the imbalance side of the tree, up to the root<br /><b><span style="color: red;">Rotation maybe required after deletion: O(logN)&nbsp;</span></b>We need to go all the way up to the root<br /><br /><br />&nbsp; </div><div><br /></div>